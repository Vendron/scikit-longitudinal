<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>scikit_longitudinal.estimators.ensemble.nested_trees.nested_trees API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;border-radius:10px;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){table{width:100%;border-collapse:separate;border-spacing:0;margin-bottom:20px;margin-top:20px;background-color:#FAFAFA;box-shadow:0 8px 16px 0 rgba(0,0,0,0.2);border-radius:10px}th,td{text-align:left;padding:15px}td h3{text-align:center;font-weight:bold}th{text-align:center;background-color:#F5F5F5}tr:nth-child(even){background-color:#F9F9F9}tr:hover{background-color:#F5F5F5}th:first-child,td:first-child{border-top-left-radius:10px;border-bottom-left-radius:10px}th:last-child,td:last-child{border-top-right-radius:10px;border-bottom-right-radius:10px}#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>scikit_longitudinal.estimators.ensemble.nested_trees.nested_trees</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="scikit_longitudinal.estimators.ensemble.nested_trees.nested_trees.NestedTreesClassifier"><code class="flex name class">
<span>class <span class="ident">NestedTreesClassifier</span></span>
<span>(</span><span>features_group: List[List[int]] = None, non_longitudinal_features: List[Union[str, int]] = None, max_outer_depth: int = 3, max_inner_depth: int = 2, min_outer_samples: int = 5, inner_estimator_hyperparameters: Optional[Dict[str, Any]] = None, save_nested_trees: bool = False, parallel: bool = False, num_cpus: int = -1)</span>
</code></dt>
<dd>
<div class="desc"><p>Nested Trees Classifier for longitudinal data.</p>
<p>The Nested Trees Classifier is a unique and innovative classification algorithm specifically designed for
longitudinal datasets. The algorithm in question is designed to create a model that bears resemblance to
traditional decision tree algorithms. However, it distinguishes itself by employing a unique approach: instead of
utilising straightforward attribute-value tests as nodes in the tree, it employs smaller decision trees nested
within. The implementation results in the establishment of a hierarchical framework consisting of a primary tree
structure encompassing subordinate decision trees nested within each node. This design optimally leverages the
longitudinal data's inherent information. The outer decision employs a bespoke decision tree algorithm that
employs a selection process for longitudinal attributes. These attributes are categorised as groups of
time-specific attributes, which are then utilised in the construction of the decision tree. The inner embedded
decision tree utilised in this system is implemented using Scikit Learn's decision tree algorithm. This algorithm
operates by partitioning the dataset into subsets based on the longitudinal attribute of the parent node.</p>
<h2 id="args">Args</h2>
<dl>
<dt>features_group (List[List[int]]):</dt>
<dt>A list of lists, where each inner list contains the indices of features that</dt>
<dt>correspond to a specific longitudinal attribute.</dt>
<dt>max_outer_depth (int, optional):</dt>
<dt>The maximum depth of the outer custom decision tree. Defaults to 3.</dt>
<dt>max_inner_depth (int, optional):</dt>
<dt>The maximum depth of the inner decision trees. Defaults to 2.</dt>
<dt><strong><code>min_outer_samples</code></strong> :&ensp;<code>int</code>, optional</dt>
<dd>T
he minimum number of samples required to split an internal node in the outer
decision tree. Defaults to 5.</dd>
</dl>
<p>inner_estimator_hyperparameters (Dict[str, Any], optional):
A dictionary of hyperparameters to be passed to the
inner Scikit-learn decision tree estimators. If not provided, default hyperparameters will be used.
Defaults to None.
save_nested_trees (bool, optional):
If set to True, the nested trees structure plot will be saved, which may be
useful for model interpretation and visualization. Defaults to False.</p>
<h2 id="attributes">Attributes</h2>
<p>root (Node, optional):
The root node of the outer decision tree. Set to None upon initialisation, it will be
updated during the model fitting process. Defaults to None.</p>
<h2 id="examples">Examples</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; from nested_trees import NestedTreesClassifier
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; X = np.array([[1, 2, 3, 4], [2, 3, 4, 5], [3, 4, 5, 6], [4, 5, 6, 7]])
&gt;&gt;&gt; y = np.array([0, 1, 0, 1])
&gt;&gt;&gt; group_features = [[0, 1], [2, 3]]
&gt;&gt;&gt; clf = NestedTreesClassifier(features_group=group_features)
&gt;&gt;&gt; clf.fit(X, y)
&gt;&gt;&gt; clf.predict(X)
</code></pre>
<h2 id="notes">Notes</h2>
<p>For more information, see the following paper of the Nested Trees algorithm:</p>
<p>Ovchinnik, S., Otero, F. and Freitas, A.A., 2022, April. Nested trees for
longitudinal classification. In Proceedings of the 37th ACM/SIGAPP Symposium on
Applied Computing (pp. 441-444). Vancouver</p>
<p>Here is the initial Java implementation of the NESTED TREES algorithm:
<a href="https://github.com/NestedTrees/NestedTrees">https://github.com/NestedTrees/NestedTrees</a></p>
<p>See Also:
CustomClassifierMixinEstimator: Base class for all Classifier Mixin estimators in scikit-learn that we
customized so that the original scikit-learn "check_x_y" is performed all the time.</p>
<p>Initialize the NestedTreesClassifier.</p>
<h2 id="args_1">Args</h2>
<p>features_group : List[List[int]]
A list of lists, where each inner list contains the indices of features that
correspond to a specific longitudinal attribute.
max_outer_depth : int, optional (default=None)
The maximum depth of the outer decision tree. If None, the tree is grown until all leaves are pure.
max_inner_depth : int, optional (default=None)
The maximum depth of the inner decision trees. If None, the trees are grown until all leaves are pure.
inner_estimator_hyperparameters : Optional[Dict[str, Any]], optional (default=None)
A dictionary of hyperparameters to pass to the inner decision tree estimators.
parallel : bool, optional (default=False)
If True, use parallelization for fitting inner trees.
save_nested_trees : bool, optional (default=False)
If True, save inner decision tree visualizations as image files.</p></div>
<h3>Class variables</h3>
<dl>
<dt id="scikit_longitudinal.estimators.ensemble.nested_trees.nested_trees.NestedTreesClassifier.Node"><code class="name">var <span class="ident">Node</span></code></dt>
<dd>
<div class="desc"><p>A node in the outer decision tree of the Nested Trees Classifier.</p>
<p>Each node in the outer tree contains an inner decision tree. Leaf nodes
are associated with a class label, while non-leaf nodes have a decision
criterion based on the inner decision tree.</p>
<h2 id="args">Args</h2>
<p>is_leaf (bool):
Determines if the node is a leaf node. If True, the node represents a class label and has access to the
tree associated with the last step it took to construct the leaf node; otherwise, it is an internal node
with a decision criterion based on the inner decision tree.
tree (DecisionTreeClassifier):
A Scikit-learn DecisionTreeClassifier instance representing the inner decision tree for this node.
node_name (str):
A unique name for the node, used for visualization and debugging purposes.
group (Optional[List[int]]):
A list of feature group indices used to split the data in this node.
Defaults to None.</p>
<h2 id="attributes">Attributes</h2>
<p>is_leaf (bool):
Indicates whether the node is a leaf node.
tree (DecisionTreeClassifier):
The inner decision tree associated with this node.
children (List[Node]):
A list of child nodes of this node in the outer decision tree.
children_map (Dict[str, Node]):
A dictionary mapping the name of each child node to the corresponding Node instance.
node_name (str):
The unique name of this node.
group (Optional[List[int]]):
A list of feature group indices used to split the data in this node.</p>
<h2 id="raises">Raises</h2>
<p>ValueError:
If tree is not provided, or if node_name is an empty string.</p>
<h2 id="examples">Examples</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; from sklearn_fork.tree import DecisionTreeClassifier
&gt;&gt;&gt; inner_tree = DecisionTreeClassifier()
&gt;&gt;&gt; node = Node(is_leaf=False, tree=inner_tree, node_name=&quot;dummy_node&quot;)
</code></pre></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="scikit_longitudinal.estimators.ensemble.nested_trees.nested_trees.NestedTreesClassifier.print_nested_tree"><code class="name flex">
<span>def <span class="ident">print_nested_tree</span></span>(<span>self, node: Optional[ForwardRef('<a title="scikit_longitudinal.estimators.ensemble.nested_trees.nested_trees.NestedTreesClassifier.Node" href="#scikit_longitudinal.estimators.ensemble.nested_trees.nested_trees.NestedTreesClassifier.Node">NestedTreesClassifier.Node</a>')] = None, depth: int = 0, prefix: str = '', parent_name: str = '') ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Print the structure of the nested tree classifier.</p>
<h2 id="args">Args</h2>
<p>node (Optional[NestedTreesClassifier.Node], optional):
The current node in the outer decision tree. If None, start from the root node. Default is None.
depth (int, optional):
The current depth of the node in the outer decision tree. Default is 0.
prefix (str, optional):
A string to prepend before the node's name in the output. Default is "".
parent_name (str, optional):
The name of the parent node in the outer decision tree. Default is "".</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="scikit_longitudinal.estimators.ensemble.nested_trees" href="index.html">scikit_longitudinal.estimators.ensemble.nested_trees</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="scikit_longitudinal.estimators.ensemble.nested_trees.nested_trees.NestedTreesClassifier" href="#scikit_longitudinal.estimators.ensemble.nested_trees.nested_trees.NestedTreesClassifier">NestedTreesClassifier</a></code></h4>
<ul class="">
<li><code><a title="scikit_longitudinal.estimators.ensemble.nested_trees.nested_trees.NestedTreesClassifier.Node" href="#scikit_longitudinal.estimators.ensemble.nested_trees.nested_trees.NestedTreesClassifier.Node">Node</a></code></li>
<li><code><a title="scikit_longitudinal.estimators.ensemble.nested_trees.nested_trees.NestedTreesClassifier.print_nested_tree" href="#scikit_longitudinal.estimators.ensemble.nested_trees.nested_trees.NestedTreesClassifier.print_nested_tree">print_nested_tree</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>